package rmidemo;

import java.rmi.*;
import javax.swing.*;
import java.awt.*;

public class StudentClient extends javax.swing.JApplet {
  // Declare a Student instance
  Student student;
  
  boolean isStandalone;
  
  /** Creates new form StudentClient */
  public void init() {
    initComponents();
    
    // Initialize RMI
    initializeRMI();
  }
  
  /** This method is called from within the constructor to
   * initialize the form.
   * WARNING: Do NOT modify this code. The content of this method is
   * always regenerated by the Form Editor.
   */
  private void initComponents() {//GEN-BEGIN:initComponents
      jbtGetScore = new javax.swing.JButton();
      jPanel1 = new javax.swing.JPanel();
      jlblName = new javax.swing.JLabel();
      jtfName = new javax.swing.JTextField();
      jlblScore = new javax.swing.JLabel();
      jtfScore = new javax.swing.JTextField();
      
      jbtGetScore.setText("Get Score");
      jbtGetScore.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
          jbtGetScoreActionPerformed(evt);
        }
      });
      
      getContentPane().add(jbtGetScore, java.awt.BorderLayout.SOUTH);
      
      jPanel1.setLayout(new java.awt.GridLayout(2, 2));
      
      jlblName.setText("Name");
      jPanel1.add(jlblName);
      
      jPanel1.add(jtfName);
      
      jlblScore.setText("Score");
      jPanel1.add(jlblScore);
      
      jPanel1.add(jtfScore);
      
      getContentPane().add(jPanel1, java.awt.BorderLayout.CENTER);
    
  }//GEN-END:initComponents
  
    private void jbtGetScoreActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtGetScoreActionPerformed
      try {
        // Get student score
        double score = student.findScore(jtfName.getText().trim());
        
        // Display the result
        if (score < 0)
          jtfScore.setText("Not found");
        else
          jtfScore.setText(new Double(score).toString());
      }
      catch(Exception ex) {
        System.out.println(ex);
      }
    }//GEN-LAST:event_jbtGetScoreActionPerformed
    
    /** Initialize RMI */
    protected void initializeRMI() {
      String url;
      
      if (isStandalone) {
        // System.setSecurityManager(new RMISecurityManager());
        
        url = "rmi:///";
        // Use rmi://hostname/ if the server is located on hostname,
        // i.e. rmi://liang.armstrong.edu/
      }
      else {
        // Initialize RMI for an applet
        url = getCodeBase().getHost();
        if (url.equals("default")) url = "";
        url = "rmi://" + url + "/";
      }
      
      try {
        student = (Student)Naming.lookup(url + "StudentImpl");
        System.out.println("Server object " + student + " found");
      }
      catch(Exception ex) {
        System.out.println(ex);
      }
    }
    
    /**Main method*/
    public static void main(String[] args) {
      StudentClient applet = new StudentClient();
      applet.isStandalone = true;
      JFrame frame = new JFrame();
      frame.setTitle("StudentClient");
      frame.getContentPane().add(applet, BorderLayout.CENTER);
      frame.setSize(250, 150);
      applet.init();
      Dimension d = Toolkit.getDefaultToolkit().getScreenSize();
      frame.setLocation((d.width - frame.getSize().width) / 2,
      (d.height - frame.getSize().height) / 2);
      frame.setVisible(true);
      frame.setDefaultCloseOperation(3);
    }
    
  // Variables declaration - do not modify//GEN-BEGIN:variables
  private javax.swing.JButton jbtGetScore;
  private javax.swing.JPanel jPanel1;
  private javax.swing.JLabel jlblName;
  private javax.swing.JTextField jtfName;
  private javax.swing.JLabel jlblScore;
  private javax.swing.JTextField jtfScore;
  // End of variables declaration//GEN-END:variables
}